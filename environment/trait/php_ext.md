项目运行过程中，可能需要额外的扩展支持，这时我们不可避免要去安装动态扩展

::: code-group

```bash [依赖库]
# 使用 phpize 初始化 configure 配置文件时，需要 autoconf 依赖库
apt install autoconf -y
```

```ini [配置文件-默认]
# /server/php/84/lib/php.ini
extension=redis
extension=mongodb
extension=yaml
extension=apcu

;zend_extension=opcache
zend_extension=xdebug

[xdebug]
# xdebug.mode=off
xdebug.mode=develop,coverage,debug,gcstats,profile,trace
xdebug.client_host=127.0.0.1
# xdebug.client_host=192.168.66.254
xdebug.client_port=9084
```

```ini [配置文件-7.4]
# /server/php/74/lib/php.ini
extension=redis
extension=mongodb
extension=yaml
extension=apcu

;zend_extension=opcache
zend_extension=xdebug

[xdebug]
# xdebug.mode=off
xdebug.mode=develop,debug,trace
xdebug.client_host=127.0.0.1
# xdebug.client_host=192.168.66.254
xdebug.client_port=9074
```

```bash [测试扩展-默认]
# 加入环境变量的php版本
php --ri xdebug
php --ri redis
php --ri mongodb
php --ri yaml
php --ri apcu
```

```bash [测试扩展-7.4]
/server/php/74/bin/php --ri xdebug
/server/php/74/bin/php --ri redis
/server/php/74/bin/php --ri mongodb
/server/php/74/bin/php --ri yaml
/server/php/74/bin/php --ri apcu
```

:::

::: warning 注意
在测试环境（Debian12 发行版）中安装 php-7.4.33 的 PECL 扩展，需要 [使用特定版本的 Autoconf](#use-) 来生成 configure 文件！
:::

#### 使用特定版本的 Autoconf {#use-}

测试环境（Debian12 发行版）使用 `/server/php/74/bin/phpize` 生成 configure 文件时，通常会出现警告，
这是因为系统自带的 Autoconf 版本为 `2.71`，从 php-7.4.33 源码包的 configure 文件开头可以看到，
PHP 自身是使用 `Autoconf-2.69` 来生成 configure 文件的：

```ini{3}
#! /bin/sh
# Guess values for system-dependent variables and create Makefiles.
# Generated by GNU Autoconf 2.69 for PHP 7.4.33.
...
```

我们可以自己从 [Autoconf 官网](https://ftp.gnu.org/gnu/autoconf/) 下载指定版本的包，并编译到自己的服务器上，
再将环境变量 `$PATH` 的首个检查路径设为 “刚刚编译的 Autoconf 的 bin 目录下” 这样可以确保使用该版本。

::: code-group

```bash [编译]
# 公共依赖库，请使用root账户编译
mkdir /server/autoconf-2.69
cd /root/autoconf-2.69

./configure --prefix=/server/autoconf-2.69
make -j4
make install
```

```bash [指定版本]
# 修改 $PATH 首个检查路径
export PATH=/server/autoconf-2.69/bin:$PATH
```

:::

### 1. xdebug 扩展

[xdebug](https://xdebug.org/download) 扩展安装案例：

::: code-group

```bash [编译-默认]
cd /home/php-fpm/php_ext/xdebug-3.4.1
phpize
./configure --with-php-config=/server/php/84/bin/php-config
make -j4
make install
```

```ini [配置-默认]
# 如果 Xdebug 和 OPCache 同时使用，xdebug 必须在 opcache 之后：
zend_extension=opcache
zend_extension=xdebug

[xdebug]
# xdebug.mode=off
xdebug.mode=develop,coverage,debug,gcstats,profile,trace
xdebug.client_host=127.0.0.1
# xdebug.client_host=192.168.66.254
xdebug.client_port=9084
```

```bash [编译-7.4]
cd /home/php-fpm/php_ext/xdebug-3.1.6
/server/php/74/bin/phpize
./configure --with-php-config=/server/php/74/bin/php-config
make -j4
make install
```

```ini [配置-7.4]
# 如果 Xdebug 和 OPCache 同时使用，xdebug 必须在 opcache 之后：
zend_extension=opcache
zend_extension=xdebug

[xdebug]
# xdebug.mode=off
xdebug.mode=develop,debug,trace
xdebug.client_host=127.0.0.1
# xdebug.client_host=192.168.66.254
xdebug.client_port=9074
```

:::

### 2. redis 扩展

::: code-group

```bash [默认]
cd /home/php-fpm/php_ext/redis-6.1.0
phpize
./configure --with-php-config=/server/php/84/bin/php-config
make -j4
make test
make install
```

```bash [7.4]
cd /home/php-fpm/php_ext/redis-6.1.0
/server/php/74/bin/phpize
./configure --with-php-config=/server/php/74/bin/php-config
make -j4
make test
make install
```

:::

### 3. MongoDB 扩展

::: code-group

```bash [默认]
cd /home/php-fpm/php_ext/mongodb-1.20.1
phpize
./configure --with-php-config=/server/php/84/bin/php-config
make -j4
make test
make install
```

```bash [7.4]
cd /home/php-fpm/php_ext/mongodb-1.20.1
/server/php/74/bin/phpize
./configure --with-php-config=/server/php/74/bin/php-config
make -j4
make test
make install
```

:::

### 4. yaml 扩展

::: code-group

```bash [默认]
# 安装依赖库
apt install libyaml-dev -y

cd /home/php-fpm/php_ext/yaml-2.2.4
phpize
./configure --with-php-config=/server/php/84/bin/php-config
make -j4
make test
make install
```

```bash [7.4]
# 安装依赖库
apt install libyaml-dev -y

cd /home/php-fpm/php_ext/yaml-2.2.4
/server/php/74/bin/phpize
./configure --with-php-config=/server/php/74/bin/php-config
make -j4
make test
make install
```

:::

### 5. apcu 扩展

::: code-group

```bash [默认]
cd /home/php-fpm/php_ext/apcu-5.1.24
phpize
./configure --with-php-config=/server/php/84/bin/php-config
make -j4
make test
make install
```

```bash [7.4]
cd /home/php-fpm/php_ext/apcu-5.1.24
/server/php/74/bin/phpize
./configure --with-php-config=/server/php/74/bin/php-config
make -j4
make test
make install
```

:::
