echo "/server/logs/redis/redis-server.log {
    daily                   # 每天轮转(切割)一次
    missingok               # 日志文件不存在时忽略错误，继续执行
    rotate 30               # 保留30个备份（即30天的日志）
    compress                # 压缩旧日志以节省空间（使用gzip）
    delaycompress           # 延迟压缩：本次轮转的日志在下一次轮转时才压缩
    dateext                 # 使用日期作为轮转文件的后缀
    dateformat -%Y%m%d      # 可选：自定义日期格式，例如 -20250901
    dateyesterday           # 可选：使用前一天的日期而非轮转执行日期[7](@ref)
    # dateyesterday         # 可选：使用前一天的日期而非轮转执行日期
    # copytruncate          # 复制当前日志文件后清空原文件，避免需重启Redis或发送信号（与 create 二选一）
    create 0640 redis redis # 轮转后创建的新日志文件权限和属主（用户和组请根据实际情况调整）
    sharedscripts           # 所有日志文件处理完后，只执行一次postrotate脚本
    postrotate              # 轮转后执行的脚本
        # 如果使用 copytruncate 无须发送信号，但有可能丢失极小量的日志
        # 通过pid文件向Redis进程发送USR1信号，使其重新打开日志文件
        if [ -f /run/redis/process.pid ]; then
           kill -USR1 $(cat /run/redis/process.pid)
        fi
    endscript
}" > /etc/logrotate.d/redis