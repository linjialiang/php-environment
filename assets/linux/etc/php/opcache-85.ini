[opcache]
; ------------------------------------------------------------------------
; --- 核心启用 ---
; ------------------------------------------------------------------------
opcache.enable=1
opcache.enable_cli=0

; ------------------------------------------------------------------------
; --- 内存配置 (激进) ---
; ------------------------------------------------------------------------
; 512MB (防止大型项目OOM)
opcache.memory_consumption=512
; 更大的字符串缓冲
opcache.interned_strings_buffer=32
; 根据项目文件数调整 (Laravel/Symfony建议4万+)
opcache.max_accelerated_files=20480

; ------------------------------------------------------------------------
; --- 生产策略：关闭文件验证 (极致性能) ---
; 注意：开启此配置后，更新代码必须重启PHP服务 (php-fpm restart)
; ------------------------------------------------------------------------
; 关键：关闭时间戳验证 (消除stat系统调用)
opcache.validate_timestamps=0
; (此参数在validate_timestamps=0时无效，仅为保险)
opcache.revalidate_freq=60
; 保持默认值2或设为0
opcache.file_update_protection=2

; ------------------------------------------------------------------------
; --- PHP 8.5 JIT 配置 (全力开启) ---
; ------------------------------------------------------------------------
; 更大的JIT缓冲区，防止JIT失效
opcache.jit_buffer_size=256M
; 或 opcache.jit=1255 (数值配置，功能相同)
opcache.jit=tracing
; 关闭JIT调试
opcache.jit_debug=0

; ------------------------------------------------------------------------
; --- 高级优化 ---
; ------------------------------------------------------------------------
opcache.fast_shutdown=1
; 如果启用，则在调用函数 file_exists()，is_file() 以及 is_readable() 的时候，
; 都会检查操作码缓存，无论文件是否已经被缓存。
; 如果应用中包含检查 PHP 脚本存在性和可读性的功能，这样可以提升性能。
; 但是如果禁用了 opcache.validate_timestamps 选项，可能存在返回过时数据的风险。
opcache.enable_file_override=1
opcache.optimization_level=0x7FFFBFFF
; 禁用一致性检查
opcache.consistency_checks=0
; 关闭日志
opcache.log_verbosity_level=0
; 框架依赖注解时必须为1
opcache.save_comments=0